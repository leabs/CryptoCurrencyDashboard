<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Bitcoin Ticker</title>
    <link
      rel="stylesheet"
      href="https://ds.fusioncharts.com/2.0.8/css/ds.css"
    />
    <link rel="stylesheet" href="../assets/bulma/css/bulma.css" />
    <link rel="stylesheet" href="../assets/css/styles.css" />

    <script src="https://ds.fusioncharts.com/2.0.8/js/ds.js"></script>
    <script
      type="text/javascript"
      src="https://cdn.fusioncharts.com/fusioncharts/latest/fusioncharts.js"
    ></script>
    <script
      type="text/javascript"
      src="https://cdn.fusioncharts.com/fusioncharts/latest/themes/fusioncharts.theme.fusion.js"
    ></script>
  </head>

  <body>
    <main class="has-background-light"><section class="hero is-small is-primary has-text-center">
  <div class="hero-body">
    <p class="title">CryptoCurrency Dashboard</p>
    <p class="subtitle">
      Follow the latest prices, news, and trends with the CryptoCurrency market.
    </p>
  </div>
</section>

<!--Homepage dashboard-->
<section class="section">
  <div class="container">
  <h4 class="h4">
    Current Prices
    <a onClick="window.location.reload()"
      ><img src="assets/img/refresh.png" style="height: 20px" alt="refresh" />
    </a>
  </h4>
  <br />
  <div class="columns">
    <!--Bitcoin card current price-->
    <div class="column">
      <div class="box bitcoin-box">
        <div class="h3">Bitcoin(BTC)</div>
        <div class="h5">(Price in USD)</div>
        <div id="btc_val" class="h4 kpi-value"></div>
      </div>
    </div>
    <!--Ethereum card current price-->
    <div class="column">
      <div class="box ethereum-box">
        <div class="h3">Ethereum</div>
        <div class="h5">(Price in USD)</div>
        <div id="eth_val" class="h4 kpi-value"></div>
      </div>
    </div>
    <!--Litecoin card current Price-->
    <div class="column">
      <div class="box litecoin-box">
        <div class="h3">Litecoin(LTC)</div>
        <div class="h5">(Price in USD)</div>
        <div id="ltc_val" class="h4 kpi-value"></div>
      </div>
    </div>
  </div>
  
  
  <div class="columns">
    <div class="column">
      <div class="box">
        <div id="chart-container"></div>
      </div>
    </div>
  </div>
</section>
</div>
<!--About Section-->
<section class="section" style="background-color: white">
  <div class="container has-text-center">
    <h2 class="h2 has-text-center">About</h2>
    <h4 class="h4">
      Tools I used to make this website, and where you can find more
      information.
    </h4>
    <p class="has-text-center">This site</p>
    <br />
    <div class="has-text-center">
      <div class="buttons has-text-center">
        <a
          href="https://github.com/leabs/CryptoCurrencyDashboard"
          class="button is-primary"
          target="_blank"
          >Github</a
        >
      </div>
    </div>
  </div>
</section>

  <div class="columns">
    <div class="column">
      <h3 class="h3">Blog Posts</h3>
      <div class="column">
        <ul>
          
          <li>
            <a href="/2021/02/22/welcome-to-jekyll.html">Coin Blog Introduction</a>
          </li>
          
        </ul>
      </div>
    </div>
    <div class="column">
      <h3 class="h3">RSS Feed from r/CryptoCurrency</h3>
      <div class="column">
        <script
          type="text/javascript"
          language="javascript"
          src="https://www.rssdog.com/index.php?url=http%3A%2F%2Fwww.reddit.com%2Fr%2FCryptoCurrency.rss&amp;mode=javascript&amp;showonly=&amp;maxitems=10&amp;showdescs=0&amp;desctrim=0&amp;descmax=0&amp;tabwidth=100%25&amp;linktarget=_blank&amp;bordercol=%23d4d0c8&amp;headbgcol=%23999999&amp;headtxtcol=%23ffffff&amp;titlebgcol=%23f1eded&amp;titletxtcol=%23000000&amp;itembgcol=%23ffffff&amp;itemtxtcol=%23000000&amp;ctl=0"
        ></script>
      </div>
    </div>
  </div>
</div>



<script>
  //Fetch the price of Ethereum
  const eth_api_url = "https://api.cryptonator.com/api/ticker/eth-usd";

  function ethereumHttpObject() {
    try {
      return new XMLHttpRequest();
    } catch (error) {}
  }

  function ethereumGetData() {
    var request = ethereumHttpObject();
    request.open("GET", eth_api_url, false);
    request.send(null);
    console.log(request.responseText);
    return request.responseText;
  }

  function ethereumDataHandler() {
    var raw_data_string = ethereumGetData();

    var data = JSON.parse(raw_data_string);

    var base = data.ticker.base;
    var target = data.ticker.target;
    var price = data.ticker.price;
    var volume = data.ticker.volume;
    var change = data.ticker.change;
    var api_server_epoch_timestamp = data.timestamp;
    var api_success = data.success;
    var api_error = data.error;
    return price;
  }

  document.getElementById("eth_val").innerHTML =
    "$" + Math.round(ethereumDataHandler());

  //Fetch the price of Litecoin
  const ltc_api_url = "https://api.cryptonator.com/api/ticker/ltc-usd";

  function litecoinHttpObject() {
    try {
      return new XMLHttpRequest();
    } catch (error) {}
  }

  function litecoinGetData() {
    var request = litecoinHttpObject();
    request.open("GET", ltc_api_url, false);
    request.send(null);
    //console.log(request.responseText);
    return request.responseText;
  }

  function litecoinDataHandler() {
    var raw_data_string = litecoinGetData();
    var data = JSON.parse(raw_data_string);
    var base = data.ticker.base;
    var target = data.ticker.target;
    var price = data.ticker.price;
    var volume = data.ticker.volume;
    var change = data.ticker.change;
    var api_server_epoch_timestamp = data.timestamp;
    var api_success = data.success;
    var api_error = data.error;
    return price;
  }
  document.getElementById("ltc_val").innerHTML =
    "$" + Math.round(litecoinDataHandler());

  //Fetch the value of Bitcoin
  const api_url = "https://api.cryptonator.com/api/ticker/btc-usd";

  const time_interval = 2;

  function addLeadingZero(num) {
    return num <= 9 ? "0" + num : num;
  }

  function clientDateTime() {
    var date_time = new Date();
    // var weekday = date_time.getDay();
    // var today_date = date_time.getDate();
    // var month = date_time.getMonth();
    // var full_year = date_time.getFullYear();
    var curr_hour = date_time.getHours();
    var zero_added_curr_hour = addLeadingZero(curr_hour);
    var curr_min = date_time.getMinutes();
    var curr_sec = date_time.getSeconds();
    var curr_time = zero_added_curr_hour + ":" + curr_min + ":" + curr_sec;
    return curr_time;
  }

  function makeHttpObject() {
    try {
      return new XMLHttpRequest();
    } catch (error) {}
  }

  function bitcoinGetData() {
    var request = makeHttpObject();
    request.open("GET", api_url, false);
    request.send(null);
    return request.responseText;
  }

  function bitcoinDataHandler() {
    var raw_data_string = bitcoinGetData();
    var data = JSON.parse(raw_data_string);
    var base = data.ticker.base;
    var target = data.ticker.target;
    var price = data.ticker.price;
    var volume = data.ticker.volume;
    var change = data.ticker.change;
    var api_server_epoch_timestamp = data.timestamp;
    var api_success = data.success;
    var api_error = data.error;
    return price;
  }

  document.getElementById("btc_val").innerHTML =
    "$" + Math.round(bitcoinDataHandler());

  FusionCharts.ready(function () {
    var fusioncharts = new FusionCharts({
      id: "stockRealTimeChart",
      type: "realtimeline",
      renderAt: "chart-container",
      width: "100%",
      height: "350",
      dataFormat: "json",
      dataSource: {
        chart: {
          caption: "Bitcoin Ticker",
          subCaption: "",
          xAxisName: "Local Time",
          yAxisName: "USD",
          numberPrefix: "$",
          refreshinterval: "2",
          slantLabels: "1",
          numdisplaysets: "10",
          labeldisplay: "rotate",
          showValues: "0",
          showRealTimeValue: "0",
          theme: "fusion",
          yAxisMaxValue: bitcoinDataHandler().toString() + 20,
          yAxisMinValue: bitcoinDataHandler().toString() - 20,
        },
        categories: [
          {
            category: [
              {
                label: clientDateTime().toString(),
              },
            ],
          },
        ],
        dataset: [
          {
            data: [
              {
                value: bitcoinDataHandler().toString(),
              },
            ],
          },
        ],
      },
      events: {
        initialized: function (e) {
          function updateData() {
            // Get reference to the chart using its ID
            var chartRef = FusionCharts("stockRealTimeChart"),
              x_axis = clientDateTime(),
              y_axis = bitcoinDataHandler(),
              strData = "&label=" + x_axis + "&value=" + y_axis;
            // Feed it to chart.
            chartRef.feedData(strData);
          }
          e.sender.chartInterval = setInterval(function () {
            updateData();
          }, time_interval * 2000);
        },
        disposed: function (evt, arg) {
          clearInterval(evt.sender.chartInterval);
        },
      },
    });
    fusioncharts.render();
  });
</script>
</main>
  </body>
</html>
